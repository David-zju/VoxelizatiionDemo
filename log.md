#### 05xx model
run.json: 
Material: SolderMask
Material: Vacuum
Material: DieLayer
Material: PEC

run1.json:
SolderMask 2
DieLayer 11
Vacuum 77
Copper 31

run2.json:
Material: Vacuum
Material: PEC

run3.json:
Material: Vacuum
Material: PEC

#### 精度选择上
读取json模块选择float是因为cst导出的数据类型为float
我们在内部计算的时候最后都转换成double

#### 注意c++对于STL的越界访问是不会检查的，所以可能得注意一下

#### 函数以及模块说明
`stl_loader`用的是第三方开源库 https://sreiter.github.io/stl_reader/index.html
- `load_entities`
  - 读取json和stl，并以`std::vector<Entity>`的形式存储
- `get_bool_property`
  - `get_property`
    - 读取json中的零件的材料名称，返回`std::vector<std::string>`
  - 由于只有run1中有金属，且金属只有Copper，因此我们只需要找到零件名称是Copper的就可以
  - 输出为`std::vector<bool>`

#### stl模型测试
run1 模型中最小的零件为12个面片，最大可达27810个面片
MHT 模型的情况差不多，不过MHT的模型个数更多一些
因此决定还是需要一些加速结构的
28号发现了一个极大的问题，stl自己的normal精度很低，模长甚至有超过千分之一的误差，normal改成自己重新算的

#### 应用算法
- BVH tree作为三角网格表示的加速格式
- AABB包围盒初判
- 初步判断零件与box是否有交，需要应用AST算法（分离轴算法）
  - https://zhuanlan.zhihu.com/p/138293968
  - https://cniter.github.io/posts/ff29de94.html

#### 脚手架
- [x] 判断json与stl模型文件长度一致被注释了
- [x] 三角形的debug_id
- [x] 不要初始化cell_list 的坐标
#### run1中entities的三角形个数
| Index | Triangle num | Preprocess Time |
|-------|-------|------------------------|
| 0     | 108   |                        |
| 1     | 12    |                        |
| 2     | 84    |                        |
| 3     | 164   |                        |
| 4     | 12    |                        |
| 5     | 12    |                        |
| 6     | 12    |                        |
| 7     | 12    |                        |
| 8     | 12    |                        |
| 9     | 12    |                        |
| 10    | 19240 |                        |
| 11    | 11162 |                        |
| 12    | 15202 |                        |
| 13    | 12    |                        |
| 14    | 12    |                        |
| 15    | 12    |                        |
| 16    | 148   |                        |
| 17    | 172   |                        |
| 18    | 52    |                        |
| 19    | 84    |                        |
| 20    | 52    |                        |
| 21    | 164   |                        |
| 22    | 12    |                        |
| 23    | 164   |                        |
| 24    | 164   |                        |
| 25    | 164   |                        |
| 26    | 164   |                        |
| 27    | 164   |                        |
| 28    | 12    |                        |
| 29    | 12    |                        |
| 30    | 12    |                        |
| 31    | 64    |                        |
| 32    | 164   |                        |
| 33    | 124   |                        |
| 34    | 164   |                        |
| 35    | 12    |                        |
| 36    | 12    |                        |
| 37    | 12    |                        |
| 38    | 12    |                        |
| 39    | 12    |                        |
| 40    | 2     |                        |
| 41    | 17754 |                        |
| 42    | 25916 |                        |
| 43    | 4938  |                        |
| 44    | 12    |                        |
| 45    | 12    |                        |
| 46    | 12    |                        |
| 47    | 164   |                        |
| 48    | 116   |                        |
| 49    | 126   |                        |
| 50    | 130   |                        |
| 51    | 132   |                        |
| 52    | 12    |                        |
| 53    | 164   |                        |
| 54    | 164   |                        |
| 55    | 164   |                        |
| 56    | 84    |                        |
| 57    | 164   |                        |
| 58    | 68    |                        |
| 59    | 12    |                        |
| 60    | 12    |                        |
| 61    | 226   |                        |
| 62    | 164   |                        |
| 63    | 164   |                        |
| 64    | 164   |                        |
| 65    | 12    |                        |
| 66    | 12    |                        |
| 67    | 12    |                        |
| 68    | 12    |                        |
| 69    | 12    |                        |
| 70    | 2     |                        |
| 71    | 10524 |                        |
| 72    | 5896  | Time taken: 159.664 s |
| 73    | 12024 |                        |
| 74    | 12    |                        |
| 75    | 12    |                        |
| 76    | 12    |                        |
| 77    | 92    |                        |
| 78    | 132   |                        |
| 79    | 84    |                        |
| 80    | 52    |                        |
| 81    | 60    |                        |
| 82    | 12    |                        |
| 83    | 164   |                        |
| 84    | 164   |                        |
| 85    | 164   |                        |
| 86    | 124   |                        |
| 87    | 164   |                        |
| 88    | 12    |                        |
| 89    | 12    |                        |
| 90    | 12    |                        |
| 91    | 280   |                        |
| 92    | 132   |                        |
| 93    | 164   |                        |
| 94    | 68    |                        |
| 95    | 12    |                        |
| 96    | 12    |                        |
| 97    | 12    |                        |
| 98    | 12    |                        |
| 99    | 12    |                        |
| 100   | 78420 |                        |
| 101   | 27810 | Time taken: 1574.94 s |
| 102   | 13316 | Time taken: 341.109 s |
| 103   | 15900 |                        |
| 104   | 12    |                        |
| 105   | 12    |                        |
| 106   | 12    |                        |
| 107   | 156   |                        |
| 108   | 144   |                        |
| 109   | 116   |                        |
| 110   | 128   |                        |
| 111   | 140   |                        |
| 112   | 12    |                        |
| 113   | 164   |                        |
| 114   | 164   |                        |
| 115   | 164   |                        |
| 116   | 164   |                        |
| 117   | 164   |                        |
| 118   | 12    |                        |
| 119   | 12    |                        |
| 120   | 12    |                        |

---
MacOs debug 模式
测试了几个case 8个线程
第一个预处理clash，3.36741 s，voxelization用时14.9412
前9个预处理Time taken: 14.7457 s，voxelization用时15.0202
前9个单线程Time taken: 75.758 s， voxelization 15.7025 s
第一个单线程18.2387 s， 15.6936 s
如果不使用BVH树加速的话
第一个预处理clash 55.6106s voxelization 用时24.134
前9个预处理clash 196.428 s voxelization 用时23.9844

与零件相交的cell太少了，时间根本测不出来（全部遍历一遍大概是15s）
---
有切片文件还是要用，直接算box求交太慢了
重新把读取切片的一些东西放在Pixel.h中
---
高老师说，可以直接使用box初判结果就可以了
测试结果表明，实际上对于前9个小模型来说，区别不大，大部分其实就是在做box初判
---
测试结果：
26个线程： 28538.9 s  22254.6 s
12个线程： 28283.4 s  38182.7 s
测试12个线程，但是box初判
26859.3 s 没有明显变化，而且后面多了很多不需要处理的cell 2553615 -> 4267460
--- 
高老师建议：
1. dexel记录改用float
2. 细分的程度可以不一样

---
分离轴算法中，同一个方向的向量叉乘可能会出现{0,0,0}的情况，这需要处理一下（main分支内已修改）
到时候要检查所有可能/0的地方
normalize函数，还有射线和三角形求交的地方Intersect函数，main分支内还没修改
---
修改为三方向的dexel，其中